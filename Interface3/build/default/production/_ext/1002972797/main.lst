MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;*******************************************************************
                      00002 ; Keypad/LCD Test Code
                      00003 ; Assembler : mpasm.exe
                      00004 ; Linker    : mplink.exe
                      00005 ; Written By : Kevin Lam
                      00006 ;*******************************************************************
                      00007 
                      00008       list p=16f877                ; list directive to define processor
                      00009       #include <p16f877.inc>        ; processor specific variable definitions
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Dec 08 2015
                      00005 ;  MPASM PIC16F877 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2015 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00541         LIST
2007   3F72           00010       __CONFIG _CP_OFF & _WDT_OFF & _BODEN_ON & _PWRTE_ON & _HS_OSC & _WRT_ENABLE_ON & _CPD_OFF & _LVP_O
                            FF
                      00011       Errorlevel -302               ; switches off message [302] Register in operand not in bank 0
                      00012       Errorlevel -305
                      00013 
                      00014       #include <lcd.inc>                           ;Import LCD control functions from lcd.asm
  0000                00001         extern  InitLCD,WR_INS,WR_DATA,ClrLCD
                      00015         #include <rtc_macros.inc>
                      00001         ;External labels
  0000                00002         extern  write_rtc,read_rtc,rtc_convert,i2c_common_setup
                      00003 
                      00004 ;RTC Macros;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00005 
                      00006 rtc_resetAll    macro
                      00007 ;input:         none
                      00008 ;output:        none
                      00009 ;desc:          Resets all the time keeping registers on the RTC to zero
                      00010         banksel         0x74
                      00011         clrf            0x74
                      00012         banksel         0x73
                      00013         clrf            0x73
                      00014     call        write_rtc               ;Write 0 to Seconds
                      00015         banksel         0x73
                      00016     incf        0x73                    ;Set register address to 1
                      00017         call            write_rtc
                      00018         banksel         0x73
                      00019     incf        0x73                    ;Set register address to 2
                      00020         call            write_rtc
                      00021         banksel         0x73
                      00022     incf        0x73                    ;Set register address to 3
                      00023         call            write_rtc
                      00024         banksel         0x73
                      00025     incf        0x73                    ;Set register address to 4
                      00026         call            write_rtc
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00027         banksel         0x73
                      00028     incf        0x73                    ;Set register address to 5
                      00029         call            write_rtc
                      00030         banksel         0x73
                      00031     incf        0x73                    ;Set register address to 6
                      00032         call            write_rtc
                      00033         endm
                      00034 
                      00035 rtc_set         macro   addliteral,datliteral
                      00036 ;input:         addliteral: value of address
                      00037 ;                       datliteral: value of data
                      00038 ;output:        none
                      00039 ;desc:          loads the data in datliteral into the 
                      00040 ;                       address specified by addliteral in the RTC
                      00041         banksel 0x73
                      00042         movlw   addliteral
                      00043         movwf   0x73
                      00044         banksel 0x74
                      00045         movlw   datliteral
                      00046         movwf   0x74    
                      00047         call    write_rtc
                      00048         endm
                      00049 
                      00050 rtc_read        macro   addliteral
                      00051 ;input:         addliteral
                      00052 ;output:        0x75, 0x77, 0x78
                      00053 ;desc:          From the selected register in the RTC, read the data
                      00054 ;                       and load it into 0x75. 0x75 is also converted into 
                      00055 ;                       ASCII characters and the tens digit is placed into
                      00056 ;                       0x77 and the ones digit is placed in 0x78
                      00057         movlw   addliteral
                      00058         banksel 0x73
                      00059         movwf   0x73
                      00060         call    read_rtc
                      00061         banksel 0x75
                      00062         movf    0x75,w
                      00063         call    rtc_convert   
                      00064         endm
                      00016 
                      00017         udata_shr
                      00018 
                      00019       
                      00020       
                      00021         cblock  0x30
  00000030            00022                 COUNTH
  00000031            00023                 COUNTM  
  00000032            00024                 COUNTL  
  00000033            00025                 Table_Counter
  00000034            00026                 lcd_tmp 
  00000035            00027                 lcd_d1
  00000036            00028                 lcd_d2
  00000037            00029                 com     
  00000038            00030                 dat
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000039            00031                 temp
  0000003A            00032                 Temp
  0000003B            00033                 Location1
  0000003C            00034                 Location2 
  0000003D            00035                 NumH
  0000003E            00036                 NumL
  0000003F            00037                 TenK
  00000040            00038                 Thou
  00000041            00039                 Hund
  00000042            00040                 Tens
  00000043            00041                 Ones
  00000044            00042                 Front1          ;51 PC
  00000045            00043                 Front2
  00000046            00044                 Front3
  00000047            00045                 Front4
  00000048            00046                 Front5
  00000049            00047                 Front6
  0000004A            00048                 Front7
  0000004B            00049                 Back1           ;58 PC
  0000004C            00050                 Back2
  0000004D            00051                 Back3
  0000004E            00052                 Back4
  0000004F            00053                 Back5
  00000050            00054                 Back6
  00000051            00055                 Back7
  00000052            00056                 distanceMoved
  00000053            00057                 isColumnThere
  00000054            00058                 frontstickerValues
  00000055            00059                 backstickerValues
  00000056            00060                 binCounter
  00000057            00061                 countdown
  00000058            00062                 counter
                      00063         endc    
                      00064 
                      00065         ;Declare constants for pin assignments (LCD on PORTD)
                      00066                 #define RS      PORTD,2
                      00067                 #define E       PORTD,3
                      00068                 #define IR1     PORTA,0
                      00069                 #define IR2     PORTA,1
                      00070                 #define US      PORTA,2
                      00071                 #define backwardsDCMotor        PORTC,5
                      00072                 #define DCMotor PORTC,6
                      00073                 #define ColMotor PORTC,7
                      00074                 
                      00075 ;distanceMoved  equ     b'0'
                      00076 
                      00077          ORG       0x0000     ;RESET vector must always be at 0x00
0000   2???           00078          goto      init       ;Just jump to the main code section.
                      00079          
                      00080          ;ORG      0x100        ;this command is sketchy
                      00081          
                      00082 ;******************************************************************
                      00083 Key      macro  value, subroutine
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00084          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
                      00085          andlw          0x0F
                      00086          xorlw          value
                      00087          btfsc          STATUS, Z
                      00088          call           subroutine
                      00089         endm
                      00090 
                      00091 Rotation macro  value
                      00092          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
                      00093          andlw          0x0F
                      00094          xorlw          value
                      00095          btfsc          STATUS, Z
                      00096          call           ShiftLeft
                      00097         endm
                      00098 
                      00099 ;***************************************
                      00100 ; Delay: ~160us macro
                      00101 ;***************************************
                      00102 LCD_DELAY macro
                      00103         movlw   0xFF
                      00104         movwf   lcd_d1
                      00105         decfsz  lcd_d1,f
                      00106         goto    $-1
                      00107         endm
                      00108         
                      00109 ;***************************************
                      00110 ; Display macro
                      00111 ;***************************************
                      00112 Display macro   Message
                      00113                 local   loop_
                      00114                 local   end_
                      00115                 clrf    Table_Counter
                      00116                 clrw            
                      00117 loop_   movf    Table_Counter,W
                      00118                 call    Message
                      00119                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
                      00120                 btfsc   STATUS,Z
                      00121                         goto    end_
                      00122                 call    WR_DATA
                      00123                 incf    Table_Counter,F
                      00124                 goto    loop_
                      00125 end_
                      00126                 endm
                      00127                 
                      00128 ;*******************************************************
                      00129 ;******             BCD                 ****************
                      00130 ;*******************************************************
                      00131         
                      00132 ;---------------- Binary (16-bit) to BCD -----------------------
                      00133 ;
                      00134 ;bin8_BCD:      ; --- Takes Binary.number in      NumL
                      00135 ;bin16_BCD:     ; --- Takes Binary.number in NumH:NumL 
                      00136                 ; --> Returns decimal.form  in TenK:Thou:Hund:Tens:Ones
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00137 ;
                      00138 ; Uses variables
                      00139 ; NumH, NumL
                      00140 ; TenK, Thou, Hund, Tens, Ones
                      00141                 
                      00142 ;BCD    macro   NumH, NumL
                      00143 
0001                  00144 bin16_BCD
0001   0E3D           00145         swapf   NumH, W
0002   390F           00146         andlw   0x0F
0003   3EF0           00147         addlw   0xF0
0004   00C0           00148         movwf   Thou 
0005   07C0           00149         addwf   Thou, F 
0006   3EE2           00150         addlw   0xE2 
0007   00C1           00151         movwf   Hund 
0008   3E32           00152         addlw   0x32 
0009   00C3           00153         movwf   Ones 
                      00154 
000A   083D           00155         movf    NumH, W 
000B   390F           00156         andlw   0x0F 
000C   07C1           00157         addwf   Hund, F 
000D   07C1           00158         addwf   Hund, F 
000E   07C3           00159         addwf   Ones, F 
000F   3EE9           00160         addlw   0xE9 
0010   00C2           00161         movwf   Tens 
0011   07C2           00162         addwf   Tens, F 
0012   07C2           00163         addwf   Tens, F 
                      00164 
0013   0E3E           00165         swapf   NumL, W 
0014   390F           00166         andlw   0x0F 
0015   07C2           00167         addwf   Tens, F 
0016   07C3           00168         addwf   Ones, F 
                      00169 
0017   0DC2           00170         rlf    Tens, F 
0018   0DC3           00171         rlf    Ones, F 
0019   09C3           00172         comf    Ones, F 
001A   0DC3           00173         rlf    Ones, F 
                      00174 
001B   083E           00175         movf    NumL, W 
001C   390F           00176         andlw   0x0F 
001D   07C3           00177         addwf   Ones, F 
001E   0DC0           00178         rlf    Thou,F 
                      00179 
001F   3007           00180         movlw   0x07 
0020   00BF           00181         movwf   TenK 
                      00182 
0021   300A           00183         movlw   0x0A
0022                  00184 Lb1
0022   03C2           00185         decf    Tens, F 
0023   07C3           00186         addwf   Ones, F 
0024   1C03           00187         btfss   STATUS, C 
0025   2???           00188         goto            Lb1 
0026                  00189 Lb2
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0026   03C1           00190         decf    Hund, F 
0027   07C2           00191         addwf   Tens, F 
0028   1C03           00192         btfss   STATUS,C 
0029   2???           00193         goto            Lb2 
002A                  00194 Lb3
002A   03C0           00195         decf    Thou, F 
002B   07C1           00196         addwf   Hund, F 
002C   1C03           00197         btfss   STATUS,C
002D   2???           00198         goto            Lb3 
002E                  00199 Lb4
002E   03BF           00200         decf    TenK, F 
002F   07C0           00201         addwf   Thou, F 
0030   1C03           00202         btfss   STATUS,C 
0031   2???           00203         goto            Lb4 
                      00204 
0032   3400           00205         retlw   0
0033   0008           00206         return
                      00207 ;endm
                      00208 
                      00209 ;***************************************
                      00210 ; Initialize
                      00211 ;***************************************
0034                  00212 init
0034   018B           00213          clrf      INTCON         ; No interrupts
                      00214 
0035   1683           00215          bsf       STATUS,RP0     ; select bank 1
0036   0185           00216          clrf      TRISA          ; All port A is output
0037   30F2           00217          movlw     b'11110010'    ; Set required keypad inputs
0038   0086           00218          movwf     TRISB
0039   0187           00219          clrf      TRISC          ; All port C is output
003A   0188           00220          clrf      TRISD          ; All port D is output
                      00221          
                      00222                   ;Set SDA and SCL to high-Z first as required for I2C
003B   1607           00223                  bsf       TRISC,4                
003C   1587           00224                  bsf       TRISC,3
                      00225 
003D   1283           00226          bcf       STATUS,RP0     ; select bank 0
003E   0185           00227          clrf      PORTA
003F   0186           00228          clrf      PORTB
0040   0187           00229          clrf      PORTC
0041   0188           00230          clrf      PORTD
                      00231          
                      00232         ;Set up I2C for communication
                      00233                  
0042   2???           00234         call       i2c_common_setup
                      00235 ;*******************************************************************************
                      00236         ; UNCOMMENT IF YOU WANT TO CHANGE THE TIME
                      00237         ;rtc_resetAll
                      00238         ;call set_rtc_time
                      00239 ;*******************************************************************************
                      00240                  
                      00241                  ;Used to set up time in RTC, load to the PIC when RTC is used for the first time
                      00242                  ;call     set_rtc_time
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00243           
0043   2???           00244          call      InitLCD        ;Initialize the LCD (code in lcd.asm; imported by lcd.inc)
                      00245           ;A/D converter attempt
                      00246          
0044   1303           00247          bcf    STATUS,RP1
0045   1683           00248          bsf    STATUS,RP0      ;Select bank 1
                      00249          
0046   1405           00250          bsf    IR1             ;makes RA0 an input
0047   1283           00251          bcf    STATUS,RP0      ; go back to bank 0
                      00252          
                      00253         ;bsf    PORTC,2         ; gives RC2 5 volts
                      00254          
                      00255         ; Set ADCON1 to use RA0 as analog input
                      00256         
                      00257         
0048   1683           00258         bsf     STATUS,RP0      ;Select bank 1
0049   3006           00259         movlw   b'00000110'     ;left justified, all inputs digital
004A   009F           00260         movwf   ADCON1                  ;All digital input, reference voltage Vdd Vss
                      00261 
                      00262         ;ADCON0
004B   1283           00263         bcf     STATUS,RP0
004C   30C5           00264         movlw   b'11000101'     ;movlw  b'11000101' selects the clock and ra0 as the reader pin
004D   009F           00265         movwf   ADCON0
                      00266         
                      00267 ;***************************************************
                      00268 ; Initialize variables and Displays
                      00269 ;****************************************************   
                      00270         Display         Welcome_Msg
  0000                    M                 local   loop_
  0000                    M                 local   end_
004E   01B3               M                 clrf    Table_Counter
004F   0103               M                 clrw            
0050   0833               M loop_   movf    Table_Counter,W
0051   2???               M                 call    Welcome_Msg
0052   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
0053   1903               M                 btfsc   STATUS,Z
0054   2???               M                         goto    end_
0055   2???               M                 call    WR_DATA
0056   0AB3               M                 incf    Table_Counter,F
0057   2???               M                 goto    loop_
0058                      M end_
                      00271 
                      00272 ;***************************************
                      00273 ; Number to Printable
                      00274 ;***************************************
                      00275 PrintNumber macro       number
                      00276         ;movf       number ,W
                      00277         movfw       number
                      00278         call        DectoChar
                      00279         call        WR_DATA
                      00280         endm
                      00281         
                      00282 ;***************************************
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00283 ; Number to Colour
                      00284 ;***************************************
                      00285 PrintCol macro      number
                      00286         movfw       number
                      00287         call        StickerColours
                      00288         call        WR_DATA
                      00289         endm    
                      00290 
                      00291 PrintColumn macro           number
                      00292         movfw       number
                      00293         call        ColumnValues
                      00294         call        WR_DATA
                      00295         endm    
                      00296         
                      00297         
                      00298 ; white and black sticker labels at bottom
                      00299         
                      00300 
                      00301 ;*******************************************************************************************************
                            *******************************************
                      00302 ;                                                                 MAIN CODE
                      00303 ;-------------------------------------------------------------------------------------------------------
                            ---------------------------------------
0058                  00304 Main    
                      00305 
                      00306 ; WAIT FOR INITIAL INPUT
0058   3000           00307         movlw   b'00'
0059   00D6           00308         movwf   binCounter      ;initialize bincounter with 0
005A   00D2           00309         movwf   distanceMoved   ;initialize distance moved with 0
                      00310 
005B   2???           00311     goto    KeypadandLCD     ;calls initial form of keypad and LCD, where  robot is waiting for input to
                             begin 
                      00312         
005C                  00313 Start   
                      00314  
                      00315 ;    goto    getTimeRTC     ; gets time from RTC clock
                      00316 ;       
                      00317 ;   MOTOR ON
                      00318     
005C   1707           00319     bsf     DCMotor
005D   3001           00320     movlw   b'1'
005E   07D2           00321     addwf   distanceMoved,f
                      00322     
                      00323 ;    movlw              0x4
                      00324 ;    subwf              distanceMoved
                      00325 ;    movlw              0x0
                      00326 ;    btfsc              STATUS,C
                      00327 ;    movlw              0x1
                      00328 ;   btfsc               W,0
005F   19D2           00329     btfsc               distanceMoved,3         ;count seven
0060   2???           00330     call                MoveBackwards
                      00331 
                      00332 ;    bsf            DCMotor                 ; begin forward movement, set appropriate bit to 1
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00333 ;    movlw   b'1'
                      00334 ;    addwf  distanceMoved,f     ; increments distanceMoved by 1 (will experimentally find binary value f
                            or 4 m)
                      00335     
                      00336     
                      00337     
                      00338     
                      00339 ;;   CHECK COLUMN
                      00340 
                      00341     ;call    ChooseIR1          ;selects IR1 for data conversion
0061   2???           00342     call    pollColumnSensor    ;checks to see if column present
0062   1C53           00343     btfss   isColumnThere,0
0063   2???           00344     goto    Start
0064   1307           00345     bcf     DCMotor
0065   2???           00346     call    HalfS
0066   1787           00347     bsf     ColMotor            ;starts motor to move arm
0067   2???           00348     call    HalfS
0068   2???           00349     call    Clear_Display
                      00350     Display OperationTime
  0000                    M                 local   loop_
  0000                    M                 local   end_
0069   01B3               M                 clrf    Table_Counter
006A   0103               M                 clrw            
006B   0833               M loop_   movf    Table_Counter,W
006C   2???               M                 call    OperationTime
006D   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
006E   1903               M                 btfsc   STATUS,Z
006F   2???               M                         goto    end_
0070   2???               M                 call    WR_DATA
0071   0AB3               M                 incf    Table_Counter,F
0072   2???               M                 goto    loop_
0073                      M end_
0073   2???           00351     call    HalfS
0074   2???           00352     call    HalfS               ;emulates arm movement
0075   1387           00353     bcf     ColMotor            ;turns off motor to move arm
0076   2???           00354     goto    Start
                      00355     
                      00356 ;   CHECK IF AT THE END OF BUCKET Line
                      00357     
                      00358 
                      00359     
                      00360     
                      00361 ;    call    pollUSsensor       ; call ultrasonic sensor
                      00362 ;    btfsc   nothingAhead,0     ;   checks if there is nothing ahead
                      00363 ;    goto    Finalize
                      00364     
                      00365 ;;   CHECK IF CONTAINER IS THERE
                      00366 ;    
                      00367 ;    btfss   withinDetectionRange,0  ; checks whether container ahead is within detection range
                      00368 ;    goto    Main
                      00369 ;   call start arm motor
                      00370 ;   call other motor
                      00371 ;    call    frontscanContainer     ; label to begin container scanning
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00372 ;    call    backscanContainer      ; label to begin container scanning
                      00373 ;    movlw  b'1'
                      00374 ;    addwf   frontbinCounter,f      ;increment the bin counters
                      00375 ;    addwf   backbinCounter,f
0077   2???           00376     goto    Finalize
                      00377     
0078                  00378 MoveBackwards
                      00379     
0078   1307           00380     bcf     DCMotor
0079   1687           00381     bsf     backwardsDCMotor
                      00382     
007A   2???           00383     goto    Finalize
                      00384     
                      00385     
                      00386     
                      00387 
                      00388 
                      00389                 
                      00390 ;-----------------------------------------------------------------------------------------------------  
                                    
                      00391 
                      00392 ;*************************************
                      00393 ;       Keypad and LCD forms        
                      00394 ;*************************************
                      00395         
                      00396         
                      00397         
007B   1C86           00398 KeypadandLCD    btfss           PORTB,1     ;Wait until data is available from the keypad
007C   2???           00399                 goto            $-1 
                      00400 
007D   0E06           00401                 swapf           PORTB,W     ;Read PortB<7:4> into W<3:0>
007E   390F           00402                 andlw           0x0F
007F   00B9           00403                 movwf           temp
                      00404                 ;Key    0x00, OperationDisplay
                      00405                 Key     0x00, Start
0080   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
0081   390F               M          andlw          0x0F
0082   3A00               M          xorlw          0x00
0083   1903               M          btfsc          STATUS, Z
0084   2???               M          call           Start
                      00406                 Key     0x01, ListDisplay
0085   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
0086   390F               M          andlw          0x0F
0087   3A01               M          xorlw          0x01
0088   1903               M          btfsc          STATUS, Z
0089   2???               M          call           ListDisplay
                      00407                 Key     0x02, AddBin
008A   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
008B   390F               M          andlw          0x0F
008C   3A02               M          xorlw          0x02
008D   1903               M          btfsc          STATUS, Z
008E   2???               M          call           AddBin
                      00408                 Rotation        0x03
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008F   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
0090   390F               M          andlw          0x0F
0091   3A03               M          xorlw          0x03
0092   1903               M          btfsc          STATUS, Z
0093   2???               M          call           ShiftLeft
                      00409                 Key     0x04, ReadStickers
0094   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
0095   390F               M          andlw          0x0F
0096   3A04               M          xorlw          0x04
0097   1903               M          btfsc          STATUS, Z
0098   2???               M          call           ReadStickers
                      00410                 Key     0x05, StickerDisplay
0099   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
009A   390F               M          andlw          0x0F
009B   3A05               M          xorlw          0x05
009C   1903               M          btfsc          STATUS, Z
009D   2???               M          call           StickerDisplay
                      00411                 Key     0x06, DisplayBlackWhite
009E   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
009F   390F               M          andlw          0x0F
00A0   3A06               M          xorlw          0x06
00A1   1903               M          btfsc          STATUS, Z
00A2   2???               M          call           DisplayBlackWhite
                      00412                 Key     0x08, pollColumnSensor
00A3   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
00A4   390F               M          andlw          0x0F
00A5   3A08               M          xorlw          0x08
00A6   1903               M          btfsc          STATUS, Z
00A7   2???               M          call           pollColumnSensor
                      00413                 Key     0x09, RTCDisplay
00A8   0E06               M          swapf          PORTB,W     ;Read PortB<7:4> into W<3:0>
00A9   390F               M          andlw          0x0F
00AA   3A09               M          xorlw          0x09
00AB   1903               M          btfsc          STATUS, Z
00AC   2???               M          call           RTCDisplay
00AD   1886           00414                 btfsc           PORTB,1     ;Wait until key is released
00AE   2???           00415                 goto            $-1
00AF   2???           00416                 goto            KeypadandLCD
                      00417                 
00B0                  00418 goback
00B0   0008           00419                 return  
                      00420                 
                      00421                 
                      00422 ;*********************************************************
                      00423 ; A to D conversion with LCD display for IR sensor
                      00424 ;*********************************************************
                      00425 
00B1                  00426 LCDConversion
00B1   1507           00427         bsf     PORTC,2         ; gives RC2 5 volts     
                      00428                 
00B2   151F           00429         bsf     ADCON0,2                ;start conversion and wait for it to complete
00B3   191F           00430         btfsc   ADCON0,2                ;LCD CONVERSION MODULE
00B4   2???           00431         goto    $-1
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00432         
00B5   081E           00433         movf    ADRESH, W
00B6   00BD           00434         movwf   NumH
00B7   081E           00435         movf    ADRESL, W
00B8   00BE           00436         movwf   NumL
                      00437         
00B9   2???           00438         call            bin16_BCD
00BA   2???           00439         call            ClrLCD
00BB   1383           00440         bcf             STATUS, IRP
00BC   3043           00441         movlw           0x43
00BD   0804           00442         movfw           FSR
00BE   3000           00443         movlw           0x0
00BF   0B56           00444         decfsz          binCounter, W
00C0   2???           00445         goto    $+2
00C1   0008           00446         return
                      00447         
00C2   0784           00448         addwf           FSR,F
00C3   3003           00449         movlw           0x3
00C4   02BF           00450         subwf           TenK
00C5   3000           00451         movlw           0x0
00C6   1803           00452         btfsc           STATUS,C
00C7   3001           00453         movlw           0x1
00C8   0080           00454         movwf           INDF
                      00455         
                      00456         PrintNumber     TenK
                          M         ;movf       number ,W
00C9   083F               M         movfw       TenK
00CA   2???               M         call        DectoChar
00CB   2???               M         call        WR_DATA
                      00457         PrintNumber     Thou
                          M         ;movf       number ,W
00CC   0840               M         movfw       Thou
00CD   2???               M         call        DectoChar
00CE   2???               M         call        WR_DATA
                      00458         PrintNumber     Hund
                          M         ;movf       number ,W
00CF   0841               M         movfw       Hund
00D0   2???               M         call        DectoChar
00D1   2???               M         call        WR_DATA
                      00459         PrintNumber     Tens
                          M         ;movf       number ,W
00D2   0842               M         movfw       Tens
00D3   2???               M         call        DectoChar
00D4   2???               M         call        WR_DATA
                      00460         PrintNumber     Ones
                          M         ;movf       number ,W
00D5   0843               M         movfw       Ones
00D6   2???               M         call        DectoChar
00D7   2???               M         call        WR_DATA
00D8   2???           00461         call            HalfS
00D9   2???           00462         call            HalfS
00DA   1107           00463         bcf     PORTC,2         ; gives RC2 5 volts
00DB   0008           00464         return
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00465 
                      00466 ;****************************
                      00467 ;       Choose IR1
                      00468 ;****************************
                      00469         
00DC                  00470 ChooseIR1
                      00471         
00DC   1405           00472         bsf     IR1             ;makes RA0 an input
00DD   30C5           00473         movlw   b'11000101'     ;movlw  b'11000101' selects the clock and ra0 as the reader pin
00DE   009F           00474         movwf   ADCON0
                      00475         
00DF   0008           00476         return
                      00477         
                      00478 ;****************************
                      00479 ;       Choose IR2
                      00480 ;****************************
                      00481         
00E0                  00482 ChooseIR2
                      00483         
00E0   1485           00484         bsf     IR2             ;makes RA0 an input
00E1   30CD           00485         movlw   b'11001101'     ;movlw  b'11000101' selects the clock and ra0 as the reader pin
00E2   009F           00486         movwf   ADCON0
                      00487         
00E3   0008           00488         return
                      00489         
                      00490 ;******************************************
                      00491 ;       Sticker Print Modules
                      00492 ;*****************************************
                      00493         
00E4                  00494 ReadStickers
00E4   1507           00495         bsf     PORTC,2         ; gives RC2 5 volts
                      00496         
                      00497         PrintNumber     TenK
                          M         ;movf       number ,W
00E5   083F               M         movfw       TenK
00E6   2???               M         call        DectoChar
00E7   2???               M         call        WR_DATA
                      00498                 
00E8   151F           00499         bsf     ADCON0,2                ;start conversion and wait for it to complete
00E9   191F           00500         btfsc   ADCON0,2                ;LCD CONVERSION MODULE
00EA   2???           00501         goto    $-1
                      00502         
00EB   081E           00503         movf    ADRESH, W
00EC   00BD           00504         movwf   NumH
00ED   081E           00505         movf    ADRESL, W
00EE   00BE           00506         movwf   NumL
                      00507         
00EF   2???           00508         call            Clear_Display
00F0   2???           00509         call            bin16_BCD
00F1   1383           00510         BCF             STATUS, IRP
00F2   3043           00511         movlw           0x43
00F3   0804           00512         movfw           FSR
00F4   3000           00513         movlw           0x0
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00F5   0B56           00514         decfsz          binCounter, W
00F6   2???           00515         goto    $+3
00F7   0008           00516         return
                      00517                         
00F8   0784           00518         addwf           FSR,F
00F9   3003           00519         movlw           0x3
00FA   02BF           00520         subwf           TenK
00FB   3000           00521         movlw           0x0
00FC   1803           00522         btfsc           STATUS,C
00FD   3001           00523         movlw           0x1
00FE   0080           00524         movwf           INDF
                      00525         
                      00526         
                      00527         PrintNumber     Thou
                          M         ;movf       number ,W
00FF   0840               M         movfw       Thou
0100   2???               M         call        DectoChar
0101   2???               M         call        WR_DATA
                      00528         PrintNumber     Hund
                          M         ;movf       number ,W
0102   0841               M         movfw       Hund
0103   2???               M         call        DectoChar
0104   2???               M         call        WR_DATA
                      00529         PrintNumber     Tens
                          M         ;movf       number ,W
0105   0842               M         movfw       Tens
0106   2???               M         call        DectoChar
0107   2???               M         call        WR_DATA
                      00530         PrintNumber     Ones
                          M         ;movf       number ,W
0108   0843               M         movfw       Ones
0109   2???               M         call        DectoChar
010A   2???               M         call        WR_DATA
010B   2???           00531         call            HalfS
010C   2???           00532         call            HalfS
                      00533         
                      00534         
010D   1107           00535         bcf     PORTC,2         ; gives RC2 5 volts
010E   2???           00536         goto        ReadStickers
                      00537         
010F                  00538 ReadBW
                      00539         
010F   1507           00540         bsf     PORTC,2         ; gives RC2 5 volts
                      00541                 
0110   151F           00542         bsf     ADCON0,2                ;start conversion and wait for it to complete
0111   191F           00543         btfsc   ADCON0,2                ;LCD CONVERSION MODULE
0112   2???           00544         goto    $-1
                      00545         
0113   081E           00546         movf    ADRESH, W
0114   00BD           00547         movwf   NumH
0115   081E           00548         movf    ADRESL, W
0116   00BE           00549         movwf   NumL
                      00550         
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0117   2???           00551         call            Clear_Display
0118   2???           00552         call            bin16_BCD
                      00553         PrintNumber     TenK
                          M         ;movf       number ,W
0119   083F               M         movfw       TenK
011A   2???               M         call        DectoChar
011B   2???               M         call        WR_DATA
                      00554         PrintNumber     Thou
                          M         ;movf       number ,W
011C   0840               M         movfw       Thou
011D   2???               M         call        DectoChar
011E   2???               M         call        WR_DATA
                      00555         PrintNumber     Hund
                          M         ;movf       number ,W
011F   0841               M         movfw       Hund
0120   2???               M         call        DectoChar
0121   2???               M         call        WR_DATA
                      00556         PrintNumber     Tens
                          M         ;movf       number ,W
0122   0842               M         movfw       Tens
0123   2???               M         call        DectoChar
0124   2???               M         call        WR_DATA
                      00557         PrintNumber     Ones
                          M         ;movf       number ,W
0125   0843               M         movfw       Ones
0126   2???               M         call        DectoChar
0127   2???               M         call        WR_DATA
0128   2???           00558         call            HalfS
0129   2???           00559         call            Clear_Display
                      00560         
                      00561 ;       BCF             STATUS, IRP
                      00562 ;       movlw           0x43
                      00563 ;       movfw           FSR
                      00564 ;       movlw           0x0
                      00565 ;       decfsz          binCounter, W
                      00566 ;       goto    $+3
                      00567 ;       return
                      00568         
                      00569 ;       addwf           FSR,F
012A   3001           00570         movlw           0x1
012B   02BF           00571         subwf           TenK
012C   3000           00572         movlw           0x0
012D   1803           00573         btfsc           STATUS,C
012E   3001           00574         movlw           0x1
                      00575 ;       movwf           INDF
                      00576         
012F   0008           00577         return
                      00578         
0130                  00579 ReadColumn
                      00580         
0130   1507           00581         bsf     PORTC,2         ; gives RC2 5 volts
                      00582                 
0131   151F           00583         bsf     ADCON0,2                ;start conversion and wait for it to complete
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0132   191F           00584         btfsc   ADCON0,2                ;LCD CONVERSION MODULE
0133   2???           00585         goto    $-1
                      00586         
0134   081E           00587         movf    ADRESH, W
0135   00BD           00588         movwf   NumH
0136   081E           00589         movf    ADRESL, W
0137   00BE           00590         movwf   NumL
                      00591         
0138   2???           00592         call            Clear_Display
0139   2???           00593         call            bin16_BCD
                      00594         PrintNumber     TenK
                          M         ;movf       number ,W
013A   083F               M         movfw       TenK
013B   2???               M         call        DectoChar
013C   2???               M         call        WR_DATA
                      00595         PrintNumber     Thou
                          M         ;movf       number ,W
013D   0840               M         movfw       Thou
013E   2???               M         call        DectoChar
013F   2???               M         call        WR_DATA
                      00596         PrintNumber     Hund
                          M         ;movf       number ,W
0140   0841               M         movfw       Hund
0141   2???               M         call        DectoChar
0142   2???               M         call        WR_DATA
                      00597         PrintNumber     Tens
                          M         ;movf       number ,W
0143   0842               M         movfw       Tens
0144   2???               M         call        DectoChar
0145   2???               M         call        WR_DATA
                      00598         PrintNumber     Ones
                          M         ;movf       number ,W
0146   0843               M         movfw       Ones
0147   2???               M         call        DectoChar
0148   2???               M         call        WR_DATA
0149   2???           00599         call            HalfS
014A   2???           00600         call            Clear_Display
                      00601         
014B   3001           00602         movlw           0x1
014C   02BF           00603         subwf           TenK                ;check tenK
014D   3000           00604         movlw           0x0
014E   1803           00605         btfsc           STATUS,C
014F   3001           00606         movlw           0x1
                      00607         
0150   0008           00608         return
                      00609         
                      00610 
                      00611 ;*********************************************
                      00612 ; Keypad Modules
                      00613 ;*******************************************
                      00614          
                      00615 
0151                  00616 Finalize
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0151   2???           00617         call        Clear_Display
                      00618         Display     WantResults
  0000                    M                 local   loop_
  0000                    M                 local   end_
0152   01B3               M                 clrf    Table_Counter
0153   0103               M                 clrw            
0154   0833               M loop_   movf    Table_Counter,W
0155   2???               M                 call    WantResults
0156   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
0157   1903               M                 btfsc   STATUS,Z
0158   2???               M                         goto    end_
0159   2???               M                 call    WR_DATA
015A   0AB3               M                 incf    Table_Counter,F
015B   2???               M                 goto    loop_
015C                      M end_
015C   2???           00619         call        Switch_Lines
                      00620         Display     WantRotate
  0000                    M                 local   loop_
  0000                    M                 local   end_
015D   01B3               M                 clrf    Table_Counter
015E   0103               M                 clrw            
015F   0833               M loop_   movf    Table_Counter,W
0160   2???               M                 call    WantRotate
0161   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
0162   1903               M                 btfsc   STATUS,Z
0163   2???               M                         goto    end_
0164   2???               M                 call    WR_DATA
0165   0AB3               M                 incf    Table_Counter,F
0166   2???               M                 goto    loop_
0167                      M end_
                      00621         
                      00622         
0167   2???           00623         goto        KeypadandLCD
                      00624         
0168                  00625 ListDisplay
0168   2???           00626         call        Clear_Display
                      00627         Display     Results1
  0000                    M                 local   loop_
  0000                    M                 local   end_
0169   01B3               M                 clrf    Table_Counter
016A   0103               M                 clrw            
016B   0833               M loop_   movf    Table_Counter,W
016C   2???               M                 call    Results1
016D   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
016E   1903               M                 btfsc   STATUS,Z
016F   2???               M                         goto    end_
0170   2???               M                 call    WR_DATA
0171   0AB3               M                 incf    Table_Counter,F
0172   2???               M                 goto    loop_
0173                      M end_
0173   2???           00628         call        Switch_Lines
                      00629         Display     Results2
  0000                    M                 local   loop_
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000                    M                 local   end_
0174   01B3               M                 clrf    Table_Counter
0175   0103               M                 clrw            
0176   0833               M loop_   movf    Table_Counter,W
0177   2???               M                 call    Results2
0178   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
0179   1903               M                 btfsc   STATUS,Z
017A   2???               M                         goto    end_
017B   2???               M                 call    WR_DATA
017C   0AB3               M                 incf    Table_Counter,F
017D   2???               M                 goto    loop_
017E                      M end_
                      00630         
017E   0008           00631         return
                      00632                 
017F                  00633 BinsDisplay
017F   2???           00634         call        Clear_Display
                      00635         Display     Bins
  0000                    M                 local   loop_
  0000                    M                 local   end_
0180   01B3               M                 clrf    Table_Counter
0181   0103               M                 clrw            
0182   0833               M loop_   movf    Table_Counter,W
0183   2???               M                 call    Bins
0184   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
0185   1903               M                 btfsc   STATUS,Z
0186   2???               M                         goto    end_
0187   2???               M                 call    WR_DATA
0188   0AB3               M                 incf    Table_Counter,F
0189   2???               M                 goto    loop_
018A                      M end_
                      00636                 
018A   0008           00637         return
                      00638         
018B                  00639 BinLocationsDisplay
018B   2???           00640         call        Clear_Display
                      00641         Display     BinLocations
  0000                    M                 local   loop_
  0000                    M                 local   end_
018C   01B3               M                 clrf    Table_Counter
018D   0103               M                 clrw            
018E   0833               M loop_   movf    Table_Counter,W
018F   2???               M                 call    BinLocations
0190   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
0191   1903               M                 btfsc   STATUS,Z
0192   2???               M                         goto    end_
0193   2???               M                 call    WR_DATA
0194   0AB3               M                 incf    Table_Counter,F
0195   2???               M                 goto    loop_
0196                      M end_
                      00642                 
0196   0008           00643         return
                      00644 
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0197                  00645 OperationTimeDisplay
0197   2???           00646         call        Clear_Display
                      00647         Display     OperationTime
  0000                    M                 local   loop_
  0000                    M                 local   end_
0198   01B3               M                 clrf    Table_Counter
0199   0103               M                 clrw            
019A   0833               M loop_   movf    Table_Counter,W
019B   2???               M                 call    OperationTime
019C   3A00               M                 xorlw   B'00000000' ;check WORK reg to see if 0 is returned
019D   1903               M                 btfsc   STATUS,Z
019E   2???               M                         goto    end_
019F   2???               M                 call    WR_DATA
01A0   0AB3               M                 incf    Table_Counter,F
01A1   2???               M                 goto    loop_
01A2                      M end_
                      00648                 
01A2   0008           00649         return
                      00650         
01A3                  00651 ShiftLeft
01A3   3018           00652         movlw           b'00011000'             ;Move to the left
01A4   2???           00653         call            WR_INS
01A5   0008           00654         return
                      00655 
01A6   2???           00656         goto Main
                      00657         
01A7                  00658 RTCDisplay
01A7   2???           00659         call    show_RTC
                      00660         
01A8   1886           00661         btfsc           PORTB,1     ;Wait until data is available from the keypad
01A9   0008           00662         return
01AA   1886           00663         btfsc           PORTB,1     ;Wait until data is available from the keypad
01AB   0008           00664         return
01AC   1886           00665         btfsc           PORTB,1     ;Wait until data is available from the keypad
01AD   0008           00666         return
01AE   1886           00667         btfsc           PORTB,1     ;Wait until data is available from the keypad
01AF   0008           00668         return
01B0   2???           00669         goto        RTCDisplay
                      00670         
01B1                  00671 AddBin
01B1   2???           00672         call            Clear_Display
                      00673         
01B2   0AD6           00674         incf            binCounter
                      00675         PrintNumber     binCounter
                          M         ;movf       number ,W
01B3   0856               M         movfw       binCounter
01B4   2???               M         call        DectoChar
01B5   2???               M         call        WR_DATA
                      00676         
01B6   0008           00677         return
                      00678         
01B7                  00679 StickerDisplay
                      00680         
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00681         ;movlw      0x1
                      00682         ;movwf      Front1
                      00683         
                      00684         
                      00685         
01B7   2???           00686         call        Clear_Display
01B8   3000           00687         movlw       0x0
01B9   00D8           00688         movwf       counter
01BA   1383           00689         BCF         STATUS,IRP
01BB   3043           00690         movlw       0x43                                ;0x43 is the front1
                      00691                                                         ;0x4A should be the back1       
01BC   0084           00692         movwf       FSR
01BD   0856           00693         movfw       binCounter
01BE   00D7           00694         movwf       countdown
                      00695         PrintNumber     TenK
                          M         ;movf       number ,W
01BF   083F               M         movfw       TenK
01C0   2???               M         call        DectoChar
01C1   2???               M         call        WR_DATA
01C2   2???           00696         call        ReadStickers
                      00697         
01C3                  00698 FrontLoop
01C3   0A84           00699         INCF        FSR,1
01C4   0AD8           00700         incf        counter
                      00701         PrintNumber counter
                          M         ;movf       number ,W
01C5   0858               M         movfw       counter
01C6   2???               M         call        DectoChar
01C7   2???               M         call        WR_DATA
01C8   2???           00702         call        HalfS
01C9   0800           00703         movfw       INDF
                      00704 
                      00705         PrintCol    W
01CA   0800               M         movfw       W
01CB   2???               M         call        StickerColours
01CC   2???               M         call        WR_DATA
01CD   0BD7           00706         decfsz      countdown,F
01CE   2???           00707         goto        FrontLoop
01CF   0008           00708         return
                      00709         
01D0                  00710 DisplayBlackWhite
01D0   2???           00711         call            ReadBW  
01D1   00C4           00712         movwf           Front1
                      00713         PrintCol        Front1
01D2   0844               M         movfw       Front1
01D3   2???               M         call        StickerColours
01D4   2???               M         call        WR_DATA
01D5   2???           00714         call            HalfS
01D6   2???           00715         call            HalfS
                      00716         
01D7   0008           00717         return
                      00718         
01D8                  00719 pollColumnSensor        ;checks to see if column present
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00720  
01D8   2???           00721         call            ReadColumn
01D9   00D3           00722         movwf           isColumnThere               ;sets the column bit 1 or 0
                      00723         PrintColumn     isColumnThere
01DA   0853               M         movfw       isColumnThere
01DB   2???               M         call        ColumnValues
01DC   2???               M         call        WR_DATA
01DD   2???           00724         call            HalfS
01DE   2???           00725         call            HalfS
                      00726         
01DF   0008           00727         return  
                      00728         
                      00729 ;***************************************
                      00730 ; LCD control
                      00731 ;***************************************
01E0                  00732 Switch_Lines
01E0   30C0           00733                 movlw   B'11000000'
01E1   2???           00734                 call    WR_INS
01E2   0008           00735                 return
                      00736 
01E3                  00737 Clear_Display
01E3   3001           00738                 movlw   B'00000001'
01E4   2???           00739                 call    WR_INS
01E5   0008           00740                 return
                      00741 
                      00742 ;***************************************
                      00743 ; Delay 0.5s
                      00744 ;***************************************
01E6                  00745 HalfS   
  0000                00746         local   HalfS_0
01E6   3088           00747       movlw 0x88
01E7   00B0           00748       movwf COUNTH
01E8   30BD           00749       movlw 0xBD
01E9   00B1           00750       movwf COUNTM
01EA   3003           00751       movlw 0x03
01EB   00B2           00752       movwf COUNTL
                      00753 
01EC                  00754 HalfS_0
01EC   0BB0           00755       decfsz COUNTH, f
01ED   2???           00756       goto   $+2
01EE   0BB1           00757       decfsz COUNTM, f
01EF   2???           00758       goto   $+2
01F0   0BB2           00759       decfsz COUNTL, f
01F1   2???           00760       goto   HalfS_0
                      00761 
01F2   2???           00762       goto $+1
01F3   0000           00763       nop
01F4   0000           00764       nop
01F5   0008           00765                 return
                      00766 
                      00767     
                      00768 ;************************************
                      00769 ; RTC Sublabels
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00770 ;************************************
                      00771     
01F6                  00772 show_RTC
                      00773                 ;clear LCD screen
01F6   3001           00774                 movlw   b'00000001'
01F7   2???           00775                 call    WR_INS
                      00776 
                      00777                 ;Get year
01F8   3032           00778                 movlw   "2"                             ;First line shows 20**/**/**
01F9   2???           00779                 call    WR_DATA
01FA   3030           00780                 movlw   "0"
01FB   2???           00781                 call    WR_DATA
                      00782                 rtc_read        0x06            ;Read Address 0x06 from DS1307---year
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
01FC   3006               M         movlw   0x06
01FD   1283 1303          M         banksel 0x73
01FF   00F3               M         movwf   0x73
0200   2???               M         call    read_rtc
0201   1283 1303          M         banksel 0x75
0203   0875               M         movf    0x75,w
0204   2???               M         call    rtc_convert   
0205   0877           00783                 movfw   0x77
0206   2???           00784                 call    WR_DATA
0207   0878           00785                 movfw   0x78
0208   2???           00786                 call    WR_DATA
                      00787 
0209   302F           00788                 movlw   "/"
020A   2???           00789                 call    WR_DATA
                      00790 
                      00791                 ;Get month
                      00792                 rtc_read        0x05            ;Read Address 0x05 from DS1307---month
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
020B   3005               M         movlw   0x05
020C   1283 1303          M         banksel 0x73
020E   00F3               M         movwf   0x73
020F   2???               M         call    read_rtc
0210   1283 1303          M         banksel 0x75
0212   0875               M         movf    0x75,w
0213   2???               M         call    rtc_convert   
0214   0877           00793                 movfw   0x77
0215   2???           00794                 call    WR_DATA
0216   0878           00795                 movfw   0x78
0217   2???           00796                 call    WR_DATA
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00797 
0218   302F           00798                 movlw   "/"
0219   2???           00799                 call    WR_DATA
                      00800 
                      00801                 ;Get day
                      00802                 rtc_read        0x04            ;Read Address 0x04 from DS1307---day
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
021A   3004               M         movlw   0x04
021B   1283 1303          M         banksel 0x73
021D   00F3               M         movwf   0x73
021E   2???               M         call    read_rtc
021F   1283 1303          M         banksel 0x75
0221   0875               M         movf    0x75,w
0222   2???               M         call    rtc_convert   
0223   0877           00803                 movfw   0x77
0224   2???           00804                 call    WR_DATA
0225   0878           00805                 movfw   0x78
0226   2???           00806                 call    WR_DATA
                      00807 
0227   30C0           00808                 movlw   B'11000000'             ;Next line displays (hour):(min):(sec) **:**:**
0228   2???           00809                 call    WR_INS
                      00810 
                      00811                 ;Get hour
                      00812                 rtc_read        0x02            ;Read Address 0x02 from DS1307---hour
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0229   3002               M         movlw   0x02
022A   1283 1303          M         banksel 0x73
022C   00F3               M         movwf   0x73
022D   2???               M         call    read_rtc
022E   1283 1303          M         banksel 0x75
0230   0875               M         movf    0x75,w
0231   2???               M         call    rtc_convert   
0232   0877           00813                 movfw   0x77
0233   2???           00814                 call    WR_DATA
0234   0878           00815                 movfw   0x78
0235   2???           00816                 call    WR_DATA
0236   303A           00817                 movlw                   ":"
0237   2???           00818                 call    WR_DATA
                      00819 
                      00820                 ;Get minute             
                      00821                 rtc_read        0x01            ;Read Address 0x01 from DS1307---min
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0238   3001               M         movlw   0x01
0239   1283 1303          M         banksel 0x73
023B   00F3               M         movwf   0x73
023C   2???               M         call    read_rtc
023D   1283 1303          M         banksel 0x75
023F   0875               M         movf    0x75,w
0240   2???               M         call    rtc_convert   
0241   0877           00822                 movfw   0x77
0242   2???           00823                 call    WR_DATA
0243   0878           00824                 movfw   0x78
0244   2???           00825                 call    WR_DATA         
0245   303A           00826                 movlw                   ":"
0246   2???           00827                 call    WR_DATA
                      00828                 
                      00829                 ;Get seconds
                      00830                 rtc_read        0x00            ;Read Address 0x00 from DS1307---seconds
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0247   3000               M         movlw   0x00
0248   1283 1303          M         banksel 0x73
024A   00F3               M         movwf   0x73
024B   2???               M         call    read_rtc
024C   1283 1303          M         banksel 0x75
024E   0875               M         movf    0x75,w
024F   2???               M         call    rtc_convert   
0250   0877           00831                 movfw   0x77
0251   2???           00832                 call    WR_DATA
0252   0878           00833                 movfw   0x78
0253   2???           00834                 call    WR_DATA
                      00835                 
0254   2???           00836                 call    OneS                    ;Delay for exactly one seconds and read DS1307 again
                      00837                 ;goto   show_RTC                ;use return instead to check for key press
0255   0008           00838                 return
                      00839 
                      00840 ;***************************************
                      00841 ; Setup RTC with time defined by user
                      00842 ;***************************************
0256                  00843 set_rtc_time
                      00844 
                      00845                 rtc_resetAll    ;reset rtc
                          M ;input:         none
                          M ;output:        none
                          M ;desc:          Resets all the time keeping registers on the RTC to zero
0256   1283 1303          M         banksel         0x74
0258   01F4               M         clrf            0x74
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0259   1283 1303          M         banksel         0x73
025B   01F3               M         clrf            0x73
025C   2???               M     call        write_rtc               ;Write 0 to Seconds
025D   1283 1303          M         banksel         0x73
025F   0AF3               M     incf        0x73                    ;Set register address to 1
0260   2???               M         call            write_rtc
0261   1283 1303          M         banksel         0x73
0263   0AF3               M     incf        0x73                    ;Set register address to 2
0264   2???               M         call            write_rtc
0265   1283 1303          M         banksel         0x73
0267   0AF3               M     incf        0x73                    ;Set register address to 3
0268   2???               M         call            write_rtc
0269   1283 1303          M         banksel         0x73
026B   0AF3               M     incf        0x73                    ;Set register address to 4
026C   2???               M         call            write_rtc
026D   1283 1303          M         banksel         0x73
026F   0AF3               M     incf        0x73                    ;Set register address to 5
0270   2???               M         call            write_rtc
0271   1283 1303          M         banksel         0x73
0273   0AF3               M     incf        0x73                    ;Set register address to 6
0274   2???               M         call            write_rtc
                      00846 
                      00847                 rtc_set 0x00,   B'10000000'
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0275   1283 1303          M         banksel 0x73
0277   3000               M         movlw   0x00
0278   00F3               M         movwf   0x73
0279   1283 1303          M         banksel 0x74
027B   3080               M         movlw   B'10000000'
027C   00F4               M         movwf   0x74    
027D   2???               M         call    write_rtc
                      00848 
                      00849                 ;set time 
                      00850                 rtc_set 0x06,   B'00010110'             ; Year
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
027E   1283 1303          M         banksel 0x73
0280   3006               M         movlw   0x06
0281   00F3               M         movwf   0x73
0282   1283 1303          M         banksel 0x74
0284   3016               M         movlw   B'00010110'
0285   00F4               M         movwf   0x74    
0286   2???               M         call    write_rtc
                      00851                 rtc_set 0x05,   B'00000010'             ; Month
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0287   1283 1303          M         banksel 0x73
0289   3005               M         movlw   0x05
028A   00F3               M         movwf   0x73
028B   1283 1303          M         banksel 0x74
028D   3002               M         movlw   B'00000010'
028E   00F4               M         movwf   0x74    
028F   2???               M         call    write_rtc
                      00852                 rtc_set 0x04,   B'00010110'             ; Date
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0290   1283 1303          M         banksel 0x73
0292   3004               M         movlw   0x04
0293   00F3               M         movwf   0x73
0294   1283 1303          M         banksel 0x74
0296   3016               M         movlw   B'00010110'
0297   00F4               M         movwf   0x74    
0298   2???               M         call    write_rtc
                      00853                 rtc_set 0x03,   B'00100001'             ; Day
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0299   1283 1303          M         banksel 0x73
029B   3003               M         movlw   0x03
029C   00F3               M         movwf   0x73
029D   1283 1303          M         banksel 0x74
029F   3021               M         movlw   B'00100001'
02A0   00F4               M         movwf   0x74    
02A1   2???               M         call    write_rtc
                      00854                 rtc_set 0x02,   B'00000001'             ; Hours
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
02A2   1283 1303          M         banksel 0x73
02A4   3002               M         movlw   0x02
02A5   00F3               M         movwf   0x73
02A6   1283 1303          M         banksel 0x74
02A8   3001               M         movlw   B'00000001'
02A9   00F4               M         movwf   0x74    
02AA   2???               M         call    write_rtc
                      00855                 rtc_set 0x01,   B'00110101'             ; Minutes
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
02AB   1283 1303          M         banksel 0x73
02AD   3001               M         movlw   0x01
02AE   00F3               M         movwf   0x73
02AF   1283 1303          M         banksel 0x74
02B1   3035               M         movlw   B'00110101'
02B2   00F4               M         movwf   0x74    
02B3   2???               M         call    write_rtc
                      00856                 rtc_set 0x00,   B'01010000'             ; Seconds
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
02B4   1283 1303          M         banksel 0x73
02B6   3000               M         movlw   0x00
02B7   00F3               M         movwf   0x73
02B8   1283 1303          M         banksel 0x74
02BA   3050               M         movlw   B'01010000'
02BB   00F4               M         movwf   0x74    
02BC   2???               M         call    write_rtc
02BD   0008           00857                 return
                      00858 
                      00859 
                      00860 ;***************************************
                      00861 ; Delay 1s
                      00862 ;***************************************
02BE                  00863 OneS
  0000                00864                 local   OneS_0
02BE   3010           00865       movlw 0x10
02BF   00B0           00866       movwf COUNTH
02C0   307A           00867       movlw 0x7A
02C1   00B1           00868       movwf COUNTM
02C2   3006           00869       movlw 0x06
02C3   00B2           00870       movwf COUNTL
                      00871 
02C4                  00872 OneS_0
02C4   0BB0           00873       decfsz COUNTH, f
02C5   2???           00874       goto   $+2
02C6   0BB1           00875       decfsz COUNTM, f
02C7   2???           00876       goto   $+2
02C8   0BB2           00877       decfsz COUNTL, f
02C9   2???           00878       goto   OneS_0
                      00879 
02CA   2???           00880       goto $+1
02CB   0000           00881       nop
02CC   0000           00882       nop
02CD   0008           00883                 return
                      00884 
                      00885 ;***************************************
                      00886 ; Print sticker values
                      00887 ;***************************************
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02CE                  00888 PrintBlackSticker
02CE   3000           00889         movlw       b'0'
02CF   2???           00890         call        StickerColours
02D0   2???           00891         call        WR_DATA
02D1   0008           00892         return
                      00893 
02D2                  00894 PrintWhiteSticker
02D2   3001           00895         movlw       b'1'
02D3   2???           00896         call        StickerColours
02D4   2???           00897         call        WR_DATA
02D5   0008           00898         return
                      00899         
                      00900 ;***************************************
                      00901 ; Look up table
                      00902 ;***************************************
                      00903     
02D6                  00904 Welcome_Msg
                      00905         
                      00906         ;Change Page
02D6   00BA           00907         movwf   Temp
02D7   30??           00908         movlw   HIGH Welcome_MsgEntries
02D8   008A           00909         movwf   PCLATH
02D9   083A           00910         movf    Temp,w
02DA   3E??           00911         addlw   LOW Welcome_MsgEntries
02DB   1803           00912         btfsc   STATUS,C
02DC   0A8A           00913             incf    PCLATH,f
02DD   0082           00914         movwf   PCL     
02DE   0782           00915         addwf    PCL,F
02DF                  00916 Welcome_MsgEntries
02DF   3450 3472 3465 00917         dt        "Press 1 to start robot", 0
       3473 3473 3420 
       3431 3420 3474 
       346F 3420 3473 
       3474 3461 3472 
       3474 3420 3472 
       346F 3462 346F 
       3474 3400 
                      00918         
02F6                  00919 Operation
                      00920         
                      00921         ;Change Page
02F6   00BA           00922         movwf    Temp
02F7   30??           00923         movlw   HIGH OperationEntries
02F8   008A           00924         movwf   PCLATH
02F9   083A           00925         movf    Temp,w
02FA   3E??           00926         addlw   LOW OperationEntries
02FB   1803           00927         btfsc   STATUS,C
02FC   0A8A           00928             incf    PCLATH,f
02FD   0082           00929         movwf   PCL
02FE   0782           00930         addwf    PCL,F
02FF                  00931 OperationEntries
02FF   344F 3470 3465 00932         dt        "Operating...",0
       3472 3461 3474 
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3469 346E 3467 
       342E 342E 342E 
       3400 
                      00933 
030C                  00934 WantResults
                      00935         
                      00936         ;Change Page
030C   00BA           00937         movwf    Temp
030D   30??           00938         movlw   HIGH WantResultsEntries
030E   008A           00939         movwf   PCLATH
030F   083A           00940         movf    Temp,w
0310   3E??           00941         addlw   LOW WantResultsEntries
0311   1803           00942         btfsc   STATUS,C
0312   0A8A           00943             incf    PCLATH,f
0313   0082           00944         movwf   PCL
0314   0782           00945         addwf    PCL,F
0315                  00946 WantResultsEntries
0315   3450 3472 3465 00947         dt        "Press 2 to display results",0
       3473 3473 3420 
       3432 3420 3474 
       346F 3420 3464 
       3469 3473 3470 
       346C 3461 3479 
       3420 3472 3465 
       3473 3475 346C 
       3474 3473 3400 
                      00948 
                      00949 
0330                  00950 WantRotate
                      00951                 
                      00952         ;Change Page
0330   00BA           00953         movwf    Temp
0331   30??           00954         movlw   HIGH WantRotateEntries
0332   008A           00955         movwf   PCLATH
0333   083A           00956         movf    Temp,w
0334   3E??           00957         addlw   LOW WantRotateEntries
0335   1803           00958         btfsc   STATUS,C
0336   0A8A           00959             incf    PCLATH,f
0337   0082           00960         movwf   PCL
0338   0782           00961         addwf    PCL,F
0339                  00962 WantRotateEntries
0339   3450 3472 3465 00963         dt        "Press A to rotate screen",0
       3473 3473 3420 
       3441 3420 3474 
       346F 3420 3472 
       346F 3474 3461 
       3474 3465 3420 
       3473 3463 3472 
       3465 3465 346E 
       3400 
                      00964         
0352                  00965 Results1 
                      00966                 
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00967         ;Change Page
0352   00BA           00968         movwf    Temp
0353   30??           00969         movlw   HIGH Results1Entries
0354   008A           00970         movwf   PCLATH
0355   083A           00971         movf    Temp,w
0356   3E??           00972         addlw   LOW Results1Entries
0357   1803           00973         btfsc   STATUS,C
0358   0A8A           00974             incf    PCLATH,f
0359   0082           00975         movwf   PCL
035A   0782           00976         addwf    PCL,F
035B                  00977 Results1Entries 
035B   3433 343A 3420 00978         dt        "3: number of bins, 6: sticker status",0
       346E 3475 346D 
       3462 3465 3472 
       3420 346F 3466 
       3420 3462 3469 
       346E 3473 342C 
       3420 3436 343A 
       3420 3473 3474 
       3469 3463 346B 
       3465 3472 3420 
       3473 3474 3461 
       3474 3475 3473 
       3400 
                      00979         
0380                  00980 Results2
                      00981         
                      00982         ;Change Page
0380   00BA           00983         movwf    Temp
0381   30??           00984         movlw   HIGH Results2Entries
0382   008A           00985         movwf   PCLATH
0383   083A           00986         movf    Temp,w
0384   3E??           00987         addlw   LOW Results2Entries
0385   1803           00988         btfsc   STATUS,C
0386   0A8A           00989             incf    PCLATH,f
0387   0082           00990         movwf   PCL     
0388   0782           00991         addwf    PCL,F
0389                  00992 Results2Entries 
0389   3436 343A 3420 00993         dt        "6: bin locations, 8: operation time",0
       3462 3469 346E 
       3420 346C 346F 
       3463 3461 3474 
       3469 346F 346E 
       3473 342C 3420 
       3438 343A 3420 
       346F 3470 3465 
       3472 3461 3474 
       3469 346F 346E 
       3420 3474 3469 
       346D 3465 3400 
                      00994         
03AD                  00995 Bins
                      00996         ;Change Page
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03AD   00BA           00997         movwf    Temp
03AE   30??           00998         movlw   HIGH BinsEntries
03AF   008A           00999         movwf   PCLATH
03B0   083A           01000         movf    Temp,w
03B1   3E??           01001         addlw   LOW BinsEntries
03B2   1803           01002         btfsc   STATUS,C
03B3   0A8A           01003             incf    PCLATH,f
03B4   0082           01004         movwf   PCL     
03B5   0782           01005         addwf    PCL,F
03B6                  01006 BinsEntries
03B6   3434 3420 3462 01007         dt        "4 bins in total",0
       3469 346E 3473 
       3420 3469 346E 
       3420 3474 346F 
       3474 3461 346C 
       3400 
                      01008         
03C6                  01009 StickerStatus
                      01010         
                      01011         ;Change Page
03C6   00BA           01012         movwf    Temp
03C7   30??           01013         movlw   HIGH StickerStatusEntries
03C8   008A           01014         movwf   PCLATH
03C9   083A           01015         movf    Temp,w
03CA   3E??           01016         addlw   LOW StickerStatusEntries
03CB   1803           01017         btfsc   STATUS,C
03CC   0A8A           01018             incf    PCLATH,f
03CD   0082           01019         movwf   PCL     
03CE   0782           01020         addwf    PCL,F
03CF                  01021 StickerStatusEntries
03CF   3442 3442 3457 01022         dt        "BBWBWWWB",0
       3442 3457 3457 
       3457 3442 3400 
                      01023         
03D8                  01024 BinLocations
                      01025         ;Change Page
03D8   00BA           01026         movwf    Temp
03D9   30??           01027         movlw   HIGH BinLocationsEntries
03DA   008A           01028         movwf   PCLATH
03DB   083A           01029         movf    Temp,w
03DC   3E??           01030         addlw   LOW BinLocationsEntries
03DD   1803           01031         btfsc   STATUS,C
03DE   0A8A           01032             incf    PCLATH,f
03DF   0082           01033         movwf   PCL     
03E0   0782           01034         addwf    PCL,F
03E1                  01035 BinLocationsEntries
03E1   3430 342E 3433 01036         dt        "0.35,0.56,0.79",0
       3435 342C 3430 
       342E 3435 3436 
       342C 3430 342E 
       3437 3439 3400 
                      01037         
03F0                  01038 OperationTime
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01039         ;Change Page
03F0   00BA           01040         movwf    Temp
03F1   30??           01041         movlw   HIGH OperationTimeEntries
03F2   008A           01042         movwf   PCLATH
03F3   083A           01043         movf    Temp,w
03F4   3E??           01044         addlw   LOW OperationTimeEntries
03F5   1803           01045         btfsc   STATUS,C
03F6   0A8A           01046             incf    PCLATH,f
03F7   0082           01047         movwf   PCL     
03F8   0782           01048         addwf    PCL,F
03F9                  01049 OperationTimeEntries
03F9   344D 346F 3476 01050         dt        "Moving Arm",0
       3469 346E 3467 
       3420 3441 3472 
       346D 3400 
                      01051         
0404                  01052 ReceivedInput
                      01053         ;Change Page
0404   00BA           01054         movwf    Temp
0405   30??           01055         movlw   HIGH ReceivedInputEntries
0406   008A           01056         movwf   PCLATH
0407   083A           01057         movf    Temp,w
0408   3E??           01058         addlw   LOW ReceivedInputEntries
0409   1803           01059         btfsc   STATUS,C
040A   0A8A           01060             incf    PCLATH,f
040B   0082           01061         movwf   PCL     
040C   0782           01062         addwf    PCL,F
040D                  01063 ReceivedInputEntries
040D   3474 3461 346B 01064         dt        "takin in large value",0
       3469 346E 3420 
       3469 346E 3420 
       346C 3461 3472 
       3467 3465 3420 
       3476 3461 346C 
       3475 3465 3400 
                      01065         
0422                  01066 SmallValueInput
                      01067         ;Change Page
0422   00BA           01068         movwf    Temp
0423   30??           01069         movlw   HIGH SmallValueInputEntries
0424   008A           01070         movwf   PCLATH
0425   083A           01071         movf    Temp,w
0426   3E??           01072         addlw   LOW SmallValueInputEntries
0427   1803           01073         btfsc   STATUS,C
0428   0A8A           01074             incf    PCLATH,f
0429   0082           01075         movwf   PCL     
042A   0782           01076         addwf    PCL,F
042B                  01077 SmallValueInputEntries
042B   3473 346D 3461 01078         dt        "small value",0
       346C 346C 3420 
       3476 3461 346C 
       3475 3465 3400 
                      01079         
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0437                  01080 DectoChar
                      01081         
                      01082         ;Change Page
0437   00BA           01083         movwf   Temp
0438   30??           01084         movlw   HIGH DectoCharEntries
0439   008A           01085         movwf   PCLATH
043A   083A           01086         movf    Temp,w
043B   3E??           01087         addlw   LOW DectoCharEntries
043C   1803           01088         btfsc   STATUS,C
043D   0A8A           01089             incf    PCLATH,f
043E   0082           01090         movwf   PCL     
043F   0782           01091         addwf    PCL,F
0440                  01092 DectoCharEntries
0440   3430 3431 3432 01093         dt        "0123456789",  0
       3433 3434 3435 
       3436 3437 3438 
       3439 3400 
                      01094         
044B                  01095 StickerColours
                      01096         
                      01097         ;Change Page
044B   00BA           01098         movwf   Temp
044C   30??           01099         movlw   HIGH StickerColoursEntries
044D   008A           01100         movwf   PCLATH
044E   083A           01101         movf    Temp,w
044F   3E??           01102         addlw   LOW StickerColoursEntries
0450   1803           01103         btfsc   STATUS,C
0451   0A8A           01104             incf    PCLATH,f
0452   0082           01105         movwf   PCL     
0453   0782           01106         addwf    PCL,F
0454                  01107 StickerColoursEntries
0454   3442 3457 3400 01108         dt        "BW",  0
                      01109         
0457                  01110 ColumnValues
                      01111         
                      01112         ;Change Page
0457   00BA           01113         movwf   Temp
0458   30??           01114         movlw   HIGH ColumnValuesEntries
0459   008A           01115         movwf   PCLATH
045A   083A           01116         movf    Temp,w
045B   3E??           01117         addlw   LOW ColumnValuesEntries
045C   1803           01118         btfsc   STATUS,C
045D   0A8A           01119             incf    PCLATH,f
045E   0082           01120         movwf   PCL     
045F   0782           01121         addwf    PCL,F
0460                  01122 ColumnValuesEntries
0460   344E 3459 3400 01123         dt        "NY",  0
                      01124 
                      01125     
3F72                  01126         END
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 34


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
AddBin                            000001B1
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
Back1                             0000004B
Back2                             0000004C
Back3                             0000004D
Back4                             0000004E
Back5                             0000004F
Back6                             00000050
Back7                             00000051
BinLocations                      000003D8
BinLocationsDisplay               0000018B
BinLocationsEntries               000003E1
Bins                              000003AD
BinsDisplay                       0000017F
BinsEntries                       000003B6
C                                 00000000
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 35


SYMBOL TABLE
  LABEL                             VALUE 

CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CKE                               00000006
CKP                               00000004
COUNTH                            00000030
COUNTL                            00000032
COUNTM                            00000031
CREN                              00000004
CSRC                              00000007
ChooseIR1                         000000DC
ChooseIR2                         000000E0
Clear_Display                     000001E3
ClrLCD                            00000000
ColMotor                          PORTC,7
ColumnValues                      00000457
ColumnValuesEntries               00000460
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DCMotor                           PORTC,6
D_A                               00000005
D_NOT_A                           00000005
DectoChar                         00000437
DectoCharEntries                  00000440
Display                           
DisplayBlackWhite                 000001D0
E                                 PORTD,3
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
F                                 00000001
FERR                              00000002
FSR                               00000004
Finalize                          00000151
Front1                            00000044
Front2                            00000045
Front3                            00000046
Front4                            00000047
Front5                            00000048
Front6                            00000049
Front7                            0000004A
FrontLoop                         000001C3
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 36


SYMBOL TABLE
  LABEL                             VALUE 

GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
HalfS                             000001E6
Hund                              00000041
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IR1                               PORTA,0
IR2                               PORTA,1
IRP                               00000007
InitLCD                           00000000
Key                               
KeypadandLCD                      0000007B
LCDConversion                     000000B1
LCD_DELAY                         
Lb1                               00000022
Lb2                               00000026
Lb3                               0000002A
Lb4                               0000002E
ListDisplay                       00000168
Location1                         0000003B
Location2                         0000003C
Main                              00000058
MoveBackwards                     00000078
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
NumH                              0000003D
NumL                              0000003E
OBF                               00000006
OERR                              00000001
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 37


SYMBOL TABLE
  LABEL                             VALUE 

OPTION_REG                        00000081
OneS                              000002BE
Ones                              00000043
Operation                         000002F6
OperationEntries                  000002FF
OperationTime                     000003F0
OperationTimeDisplay              00000197
OperationTimeEntries              000003F9
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
PrintBlackSticker                 000002CE
PrintCol                          
PrintColumn                       
PrintNumber                       
PrintWhiteSticker                 000002D2
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 38


SYMBOL TABLE
  LABEL                             VALUE 

RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RS                                PORTD,2
RSEN                              00000001
RTCDisplay                        000001A7
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
ReadBW                            0000010F
ReadColumn                        00000130
ReadStickers                      000000E4
ReceivedInput                     00000404
ReceivedInputEntries              0000040D
Results1                          00000352
Results1Entries                   0000035B
Results2                          00000380
Results2Entries                   00000389
Rotation                          
S                                 00000003
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 39


SYMBOL TABLE
  LABEL                             VALUE 

SEN                               00000000
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
SYNC                              00000004
ShiftLeft                         000001A3
SmallValueInput                   00000422
SmallValueInputEntries            0000042B
Start                             0000005C
StickerColours                    0000044B
StickerColoursEntries             00000454
StickerDisplay                    000001B7
StickerStatus                     000003C6
StickerStatusEntries              000003CF
Switch_Lines                      000001E0
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 40


SYMBOL TABLE
  LABEL                             VALUE 

TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 41


SYMBOL TABLE
  LABEL                             VALUE 

TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
Table_Counter                     00000033
Temp                              0000003A
TenK                              0000003F
Tens                              00000042
Thou                              00000040
UA                                00000001
US                                PORTA,2
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WR_DATA                           00000000
WR_INS                            00000000
WantResults                       0000030C
WantResultsEntries                00000315
WantRotate                        00000330
WantRotateEntries                 00000339
Welcome_Msg                       000002D6
Welcome_MsgEntries                000002DF
Z                                 00000002
_.org_0_007C                      0000007C
_.org_0_00AE                      000000AE
_.org_0_00B4                      000000B4
_.org_0_00C0                      000000C0
_.org_0_00EA                      000000EA
_.org_0_00F6                      000000F6
_.org_0_0112                      00000112
_.org_0_0133                      00000133
_.org_0_01ED                      000001ED
_.org_0_01EF                      000001EF
_.org_0_01F2                      000001F2
_.org_0_02C5                      000002C5
_.org_0_02C7                      000002C7
_.org_0_02CA                      000002CA
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00000FCF
_CP_HALF                          00001FDF
_CP_OFF                           00003FFF
_CP_UPPER_256                     00002FEF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 42


SYMBOL TABLE
  LABEL                             VALUE 

_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_ENABLE_OFF                   00003DFF
_WRT_ENABLE_ON                    00003FFF
_WRT_OFF                          00003DFF
_WRT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001
backstickerValues                 00000055
backwardsDCMotor                  PORTC,5
bin16_BCD                         00000001
binCounter                        00000056
com                               00000037
countdown                         00000057
counter                           00000058
dat                               00000038
distanceMoved                     00000052
frontstickerValues                00000054
goback                            000000B0
i2c_common_setup                  00000000
init                              00000034
isColumnThere                     00000053
lcd_d1                            00000035
lcd_d2                            00000036
lcd_tmp                           00000034
pollColumnSensor                  000001D8
read_rtc                          00000000
rtc_convert                       00000000
rtc_read                          
rtc_resetAll                      
rtc_set                           
set_rtc_time                      00000256
show_RTC                          000001F6
temp                              00000039
write_rtc                         00000000

MPASM 5.65                          MAIN.ASM   2-23-2016  14:50:56         PAGE 43





Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,    23 suppressed

